pipeline {

  agent {
        docker { image 'mcr.microsoft.com/dotnet/core/sdk:3.1' }
    }

  environment {
    DOTNET_CLI_HOME = "/tmp/DOTNET_CLI_HOME"
    DOTNET_CLI_TELEMETRY_OPTOUT = "true"
  }
  options {
      ansiColor('xterm')
      disableConcurrentBuilds()
      buildDiscarder(logRotator(daysToKeepStr: '30', numToKeepStr: '30', artifactDaysToKeepStr: '30'))
  }


  stages {
    stage('Checkout') {
      steps {
        checkout scm
      }
    }
    stage('Cleanup') 
    {
      steps 
      {
        sh '''
        set -e

        dotnet build
        ./awesome.configurationmanagementdatabase.ConsoleApp/bin/Debug/netcoreapp3.1/awesome.configurationmanagementdatabase.ConsoleApp
        '''
      }     
    }
  } 
  // post 
  // { 
  //   always 
  //   { 
  //     cleanWs()
  //   }
  // }
}
